<!DOCTYPE html>
<meta charset="utf-8">
<style>
.ticks {
  font: 10px sans-serif;
}

.track,
.track-inset,
.track-overlay {
  stroke-linecap: round;
}

.track {
  stroke: #000;
  stroke-opacity: 0.3;
  stroke-width: 10px;
}

.track-inset {
  stroke: #ddd;
  stroke-width: 8px;
}

.track-overlay {
  pointer-events: stroke;
  stroke-width: 50px;
  stroke: transparent;
  cursor: crosshair;
}

.handle {
  fill: #fff;
  stroke: #000;
  stroke-opacity: 0.5;
  stroke-width: 1.25px;
}
</style>
<svg width="960" height="500"></svg>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/mathjs/3.14.2/math.min.js"></script>
<script>

var hbar = 4.135667662e-15; //eV*s
var c = 299792458;
var pi = math.pi;
var n = 1.52;
var a = 50; //px
var brillouinZone = a/2
var svg = d3.select("svg"),
          margin = {right: 50, left: 50}
          width = +svg.attr("width") - margin.left - margin.right,
          height = +svg.attr("height");

var circle = svg.selectAll("circle")
                .data([1,1])
              .enter().append("circle")
                .attr("cy",100)
                .attr("cx", function(d,i) { return i * a + 250;})
                .attr("r", function(d) { return d; });

var zone = svg.selectAll("rect")
            .enter().append("rect")
              .attr("x", width/2 - brillouinZone/2)
              .attr("y", height/2 - brillouinZone/2)
              .attr("height",brillouinZone)
              .attr("width",brillouinZone)
              .attr("fill","green");

var E = d3.scaleLinear()
    .domain([1, 6])
    .range([0, width/2])
    .clamp(true);

var slider = svg.append("g")
    .attr("class","slider")
    .attr("transform","translate(" + margin.left + ", " + height / 2 + ")")

slider.append("line")
    .attr("class", "track")
    .attr("x1", E.range()[0])
    .attr("x2", E.range()[1])
  .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); })
    .attr("class", "track-inset")
  .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); })
    .attr("class", "track-overlay")
    .call(d3.drag()
        .on("start.interrupt", function() { slider.interrupt(); })
        .on("start drag", function() { k_r(E.invert(d3.event.x)); }));

slider.insert("g", ".track-overlay")
    .attr("class", "ticks")
    .attr("transform","translate(0," + 18 + ")")
  .selectAll("text")
  .data(E.ticks(10))
  .enter().append("text")
    .attr("x", E)
    .attr("text-anchor", "middle")
    .text(function(d) { return d + "eV"; });

var handle = slider.insert("circle", ".track-overlay")
    .attr("class", "handle")
    .attr("r", 9);

function k_r(energy) {
  handle.attr("cx", E(energy));
  r1 = (n*energy)/(hbar*c);
  circle.attr("r", energy*10);
}

</script>
